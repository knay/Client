{% extends "::baseAffichage.html.twig" %}

{% block title_page %}
Facture
{% endblock %}

{% block title %}
ALBA - Facture
{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('bundles/imerirvente/css/cssFacture.css') }}"/> 
{% endblock %}

{% block title_ajout %}Facture{% endblock %}

{% block ajout %}
	<table class="tableau">
		<tr>
			<th>Article</th>
			<th>Quantit&eacute</th>
			<th>Prix Unitaire</th>
			<th>Reduction</th>
			<th>Montant</th>
		</tr>
	{% if detail_facture_test is defined %}
		{% if detail_facture_test != '' %}
			{% for i in detail_facture_test %}
			<tr>
{# 				<label>numero : </label><p>{{ i.numero_facture }}</p>#}
{# 				<label>date : </label><p>{{ i.date_facture }}</p>#}
{# 				<label>client : </label><p>{{ i.nom_client }}</p>#}
				<td>{{ i.nom_article }}</td>
				<td>{{ i.nombre_article }}</td>
				<td>{{ i.prix_article }}</td>
				<td>{{ i.reduction_article }}</td>
				<td>{{ i.montant_facture }}</td>
			</tr>
			{% endfor %}
		{% else %}
		{% endif %}
	{% else %}
	{% endif %}
	</table>
{% endblock %}

{% block recherche %}
	<form method="post" action="{{ path('imerir_vente_facture') }}">
		<label>Date : </label><input type="text" id="date_de_recherche_facture" name="date" size="20" value="aaaa-mm-jj">
		<i id="bouton_supprimer_date" class="fa supprimer fa-minus-square"></i>
		<label>Client : </label><input type="text" id="recherche_client" name="client" size="20">
		<i id="bouton_supprimer_client" class="fa supprimer fa-minus-square"></i>
	<input type="submit">
	</form>
{% endblock %}

{% block table %}
    <tr>
    	<th>N&deg;</th>
    	<th>Date</th>
    	<th>Client</th>
    	<th>Montant</th>
    </tr>
    
    {% for i in result_facture %}
        <tr class="select_ligne">
        	<td>
        		<form method="post" action="{{ path('imerir_vente_facture_detail') }}" >
	        		<input type="hidden" name="ligne_numero" value="{{ i.numero }}">
    			</form>
    		{{ i.numero }}
        	</td>
        	<td>{{ i.date }}</td>
            <td>{{ i.client }}</td>
            <td>{{ i.montant }}</td>
		</tr>
		
    {% endfor %}
{% endblock %}

{% block javascripts %}
<link rel="stylesheet" href="{{ asset('../vendor/components/jqueryui/themes/smoothness/jquery-ui.css') }}"/>
<script>
var format_affichage_date = "yy-mm-dd";
var explication_client = "Nom";
$("#bouton_supprimer_date").hide();
// $("#fieldset_ajout").hide();
$("#bouton_supprimer_client").hide();
$("#date_de_recherche_facture").val('aaaa-mm-jj');
$("#recherche_client").val(explication_client);

//Permet de parametrer le datepicker
$(function() {
    $( "#date_de_recherche_facture" ).datepicker();
	$( "#date_de_recherche_facture" ).datepicker( "option", "showAnim", "slideDown" );
	$( "#date_de_recherche_facture" ).datepicker( "option", "dateFormat", format_affichage_date );
});


//Afficher l'icone de suppression lorsqu'une date est inscrite
$("#date_de_recherche_facture").change(function(){
	$("#bouton_supprimer_date").css("display","inline");
});

//Permet de gerer l'evenement du bouton de suppresion  de la date
$("#bouton_supprimer_date").click(function(){
	$( "#date_de_recherche_facture" ).val('aaaa-mm-jj');
	$("#bouton_supprimer_date").hide();
});

//Affiche l'icone de suppresion lorsque l'utilisateur saisie la recherche d'un client
$("#recherche_client").change(function(){
	$("#bouton_supprimer_client").show();
});

//Permet de gerer l'evenement sur le bouton de suppresion de la recherche client
$("#bouton_supprimer_client").click(function(){
	$("#bouton_supprimer_client").hide();
	$("#recherche_client").val(explication_client);
});

//Permet d'effacer la valeur du champ si elle est egal a nom, donc quand on click pour la premeir fois sur le input
$("#recherche_client").click(function(){
	if ($("#recherche_client").val() == explication_client){
		$("#recherche_client").val('');
	}
});

//Permet de gerer lorsque l'utilisateur click sur une ligne du tableau
$(".select_ligne").click( function(){
	$(this).find('form').submit();
});


//Permet de gerer la langue du datepicker
(function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		define([ "../jquery.ui.datepicker" ], factory );
	} else {
		factory( jQuery.datepicker );
	}
	
}(function( datepicker ) {
	datepicker.regional['fr'] = {
		closeText: 'Fermer',
		prevText: 'Pr&eacutec&eacutedent',
		nextText: 'Suivant',
		currentText: 'Aujourd\'hui',
		monthNames: ['janvier', 'f&eacutevrier', 'mars', 'avril', 'mai', 'juin',
			'juillet', 'ao&ucirct', 'septembre', 'octobre', 'novembre', 'd&eacutecembre'],
		monthNamesShort: ['janv.', 'fï¿½vr.', 'mars', 'avril', 'mai', 'juin',
			'juil.', 'ao&ucirct', 'sept.', 'oct.', 'nov.', 'd&eacutec.'],
		dayNames: ['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi'],
		dayNamesShort: ['dim.', 'lun.', 'mar.', 'mer.', 'jeu.', 'ven.', 'sam.'],
		dayNamesMin: ['D','L','M','M','J','V','S'],
		weekHeader: 'Sem.',
		dateFormat: 'yy-mm-dd',
		firstDay: 1,
		isRTL: false,
		showMonthAfterYear: false,
		yearSuffix: ''};
	datepicker.setDefaults(datepicker.regional['fr']);

	return datepicker.regional['fr'];

}));
//
</script>
{% endblock %}

